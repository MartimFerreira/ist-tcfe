\section{Theoretical Analysis}
\label{sec:analysis}
\subsection{Mesh Method}

\par
In the mesh method, the goal is to find the values of the currents in each essential mesh. The equations written in order to do this are applications of Kirchhoff's voltage law to essential meshes or determined by inspection of the circuit. If more equations are needed (because KVL couldn't be applied to one of the meshes), a super-mesh equation is written.
\par
In this method, as well as in the next one, Ohm's Law, $V=RI \Leftrightarrow I = \frac{V}{R}$, is implicitly used several times.

% explain how we got to each equation

\begin{equation}
  \begin{cases}
    V_a - R_4 (I_C-I_A) - V_b + R_1 I_A = 0 & \mbox{$(1)$}\\
    R_6 I_C + R_7 I_C - V_c + R_4(I_C-I_A) = 0 & \mbox{$(2)$}\\
    I_B = I_b & \mbox{$(3)$}\\
    I_D = I_d & \mbox{$(4)$}\\
    V_c = K_c I_c & \mbox{$(5)$} \\
    I_b = K_b V_b & \mbox{$(6)$} \\
    I_C = I_c & \mbox{$(7)$}\\
    (I_B-I_A) R_3 = V_b & \mbox{$(8)$}\\
  \end{cases}
\end{equation}

\par
KVL was applied to meshes $A$ and $C$ to obtain equations (1) and (2) respectively. KVL can't be applied to meshes $B$ and $D$, due to the current sources, so instead equations (3) and (4) were written, by direct inspection. Because the previous equations involve dependent sources, equations (5) to (8) were determined, allowing us to relate the output of said sources to the mesh currents. These could have been substituted directly into the first four equations, but we chose to show them explicitly. Equations (5) and (6) are given, equation (7) is determined by inspection of mesh $C$ and, lastly, equation (8) is the application of Ohm's law to $R_3$, with $(I_B-I_A)$ being the current that goes through that same resistor.

\begin{table}[hbt!]
  \centering
  \begin{tabular}{|c|c|}
    \hline    
    {\bf Mesh Currents} & {\bf Value [A]} \\ \hline
    \input{../mat/octave_mesh_tab.tex}
  \end{tabular}
  \caption{Mesh current values determined through mesh analysis. The results are positive or negative depending on if the currents go in the direction indicated in the introductory drawing or not}
  \label{tab:mesh}
\end{table}

\begin{table}[hbt!]
  \centering
  \begin{tabular}{|c|c|}
    \hline    
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{../mat/octave_meshextra_tab.tex}
  \end{tabular}
  \caption{Extra results obtained from solving the equation system due to us explicitly showing equations (5) to (8). These will be useful during the method comparison.}
  \label{tab:mesh}
\end{table}

%\begin{equation}
%\begin{cases}
%R_6 I_3 + R_7 I_3 - V_c + R_4(I_3-I_1) = 0 & \mbox{KVL for mesh $C$}\\
%V_a - R_4 (I_3-I_1) - V_b + R_1 I_1 = 0 & \mbox{KVL for mesh $A$}\\
%V_c = K_c I_c & \mbox{as given for voltage source $V_c$} \\
%I_b = K_b V_b & \mbox{as given for current source $I_b$} \\
%I_3 = I_c & \mbox{by inspection in mesh $C$}\\
%I_4 = I_d & \mbox{by inspection in mesh $D$}\\
%(I_2-I_1) R_3 = V_b & \mbox{Ohm's Law for resistor $R_3$}\\
%I_2 = I_b & \mbox{by inspection in mesh $B$}\\
%\end{cases}
%\end{equation}



\subsection{Nodal Method}
\par

In the nodal method, the goal is to determine all node potentials, with the set of equations written being based on Kirchhoff's current law applied to the nodes. If more equations are needed, super-node equations are used.

\begin{equation}
  \begin{cases}
    \frac{V_2-V_1}{R_1} + \frac{V_2-V_4}{R_3} + \frac{V_2-V_3}{R_2} = 0 & \mbox{$(1)$} \\
    \frac{V_3-V_2}{R_2} - (V_2-V_4) K_b = 0 & \mbox{$(2)$} \\
    \frac{V_5-V_4}{R_5} + K_b (V_2 - V_4) - I_d = 0 & \mbox{$(3)$}\\
    \frac{V_0-V_6}{R_6} - \frac{V_6-V_7}{R_7} = 0 & \mbox{$(4)$}\\
    V_0 = 0 & \mbox{$(5)$} \\
    V_1-V_0 = V_a & \mbox{$(6)$}  \\
    V_4-V_7 = K_c \frac{V_0-V_6}{R_6} & \mbox{$(7)$} \\
    \frac{V_2-V_4}{R_3} + \frac{V_5-V_4}{R_5} +  \frac{V_6-V_7}{R_7} - \frac{V_4-V_0}{R_4} - I_d = 0 & \mbox{$(8)$}
  \end{cases}
\end{equation}

\par
 In equations (1), (2), (3) and (4) we have KCL applied to nodes $N_2$, $N_3$, $N_5$ and $N_6$, respectively.  Using Ohm's law, one knows that $\frac{V_2 - V_1}{R_1}$ is the current that goes through resistor $R_1$, $\frac{V_2-V_3}{R_2}$ the one that goes through $R_2$, $\frac{V_2-V_4}{R_3}$ is the one through $R_3$, $\frac{V_5-V_4}{R_5}$ is the current through $R_5$, $\frac{V_0-V_6}{R_6}$ is the one through $R_6$ and $\frac{V_6-V_7}{R_7}$ the one through $R_7$. $I_d$ is the current imposed by current source $I_d$ while $(V_2-V_4)K_b$ is the one imposed by $I_b$. KCL can't be applied to nodes $N_0$, $N_1$, $N_4$ and $N_7$. Instead, equations (5) to (8) are written. Equation (5) refers to $N_0$ being chosen as the ground node and equation (6) is reached by inspection in voltage source $V_a$. Equation (7) is determined by inspection in voltage source $V_c$, with $V_c = K_c I_c$ being the voltage imposed by voltage source $V_c$, and $I_c$ being the current that goes through resistor $R_6$, hence it is equal to $\frac{V_0 - V_6}{R_6}$. Besides that, $V_c = V_4-V_7$. Finally, because nodes $N_4$ and $N_7$ are connected by a current source, a super-node equation, (8), can be written by algebraically summing all currents flowing into or out of these nodes (except the current imposed by the aforementioned source that connects these two nodes).



\begin{table}[hbt!]
  \centering
  \begin{tabular}{|c|c|}
    \hline    
    {\bf Node Potential} & {\bf Value [V]} \\ \hline
    \input{../mat/octave_node_tab.tex}
  \end{tabular}
  \caption{Node potentials determined through nodal analysis.}
  \label{tab:node}
\end{table}

%\begin{equation}
%\begin{cases}
%(1)V_0 = 0 & \mbox{since $N_0$ is the ground node} \\
%(2)V_1-V_0 = V_a & \mbox{by inspection in voltage source $V_a$}  \\
%(3)\frac{V_2-V_1}{R_1} + \frac{V_2-V_4}{R_3} + \frac{V_3-V_2}{R_2} = 0 & \mbox{KCL for node $N_2$} \\
%(4)\frac{V_3-V_2}{R_2} - (V_2-V_4) K_b = 0 & \mbox{KCL for node $N_3$} \\
%(5)\frac{V_0-V_6}{R_6} - \frac{V_6-V_7}{R_7} = 0 & \mbox{KCL for node $N_6$}\\
%(6)\frac{V_5-V_4}{R_5} + K_b (V_2 - V_4) - I_d = 0 & \mbox{KCL for node $N_5$}\\
%(7)V_4-V_7 = K_c \frac{V_0-V_6}{R_6} & \mbox{by inspection in voltage source $V_c$} \\
%(8)\frac{V_2-V_4}{R_3} + \frac{V_5-V_4}{R_5} +  \frac{V_6-V_7}{R_7} - \frac{V_4-V_0}{R_4} - I_d = 0 & \mbox{KCL for node $N_4$} \textcolor{red}{\textbf{     is actually a supernode!}}
%\end{cases}
%\end{equation}

\newpage
\subsection{Comparing both methods}
\label{sec:comparison}
\par


\begin{table}[hbtp!]
  \centering
  \begin{tabular}{|l|r|r|}
    \hline    
    {\bf Compared Voltages/Currents} & {\bf Mesh Method [V/A]} & {\bf Nodal Method [V/A]} \\ \hline
    \input{../mat/octave_comparison_tab.tex}
  \end{tabular}
  \caption{Comparison of all node potentials, currents through resistors as well as voltages and currents imposed by dependent sources and control voltages and currents calculated from both methods}
  \label{tab:comp}
\end{table}

\par

%\begin{equation}
%\begin{cases}
%I_{R_1}= \frac{V_2-V_1}{R_1} & \mbox{$(1)$}\\
%I_{R_2}= \frac{V_3-V_2}{R_2} & \mbox{$(2)$}\\
%I_{R_3}= \frac{V_2-V_4}{R_3} & \mbox{$(3)$}\\
%I_{R_4}= \frac{V_0-V_4}{R_4} & \mbox{$(4)$}\\
%I_{R_5}= -\frac{V_4-V_5}{R_5} & \mbox{$(5)$}\\
%I_{R_6}= -\frac{V_0-V_6}{R_6} & \mbox{$(6)$}\\
%I_{R_7}= -\frac{V_7-V_6}{R_7} & \mbox{$(7)$}\\
%I_{b}= I_{R_2} & \mbox{$(8)$}\\
%I_{c}= I_{R_6} & \mbox{$(9)$}\\
%V_{b}= V_2-V_4 & \mbox{$(10)$}\\
%V_{c}= V_4-V_7 & \mbox{$(11)$}\\
%\end{cases}
%\end{equation}

%
%\begin{equation}
%\begin{cases}
%V_{R_1}= \frac{V_2-V_1}{R_1} & \mbox{$(1)$}\\
%V_{R_2}= \frac{V_3-V_2}{R_2} & \mbox{$(2)$}\\
%V_{R_3}= \frac{V_2-V_4}{R_3} & \mbox{$(3)$}\\
%V_{R_4}= \frac{V_0-V_4}{R_4} & \mbox{$(4)$}\\
%V_{R_5}= -\frac{V_4-V_5}{R_5} & \mbox{$(5)$}\\
%V_{R_6}= -\frac{V_0-V_6}{R_6} & \mbox{$(6)$}\\
%V_{R_7}= -\frac{V_7-V_6}{R_7} & \mbox{$(7)$}\\
%\end{cases}
%\end{equation}
%}


In order to confirm that both methods lead to the same results, all nodal potentials and currents through resistors (as well as $V_b$, $V_c$, $I_b$ and $I_c$) were calculated using both methods. Some of these results come directly from solving the previously mentioned equation systems while others result from the application of Ohm's law to the resistors or of KCL to nodes connected to just 2 branches. As can be seen in table \ref{tab:comp}, both methods lead to the same results, proving their equivalence.

%\par
%Using the values obtained through the nodal analysis for the potentials, the value for the current through each essentia%l mesh was calculated and then compared to the one obtained through the mesh method as shown in the table below.

%\par
%In the previous equations Ohm's law is applied to a resistor in the respective essential mesh. In equation (4), since resistor $R_5$ belongs to two essential meshes, $B$ and $D$, the current that goes through it is the difference between the current in each of those meshes.





