\section{Theoretical Analysis}
\label{sec:analysis}
\subsection{Mesh Method}

\par
In this method, as well as in the next one, Ohm's Law, $V=RI \Leftrightarrow I = \frac{V}{R}$, is implicitly used several times.

% explain how we got to each equation

\begin{equation}
  \begin{cases}
    V_a - R_4 (I_C-I_A) - V_b + R_1 I_A = 0 & \mbox{$(1)$}\\
    R_6 I_C + R_7 I_C - V_c + R_4(I_C-I_A) = 0 & \mbox{$(2)$}\\
    I_B = I_b & \mbox{$(3)$}\\
    I_D = I_d & \mbox{$(4)$}\\
    V_c = K_c I_c & \mbox{$(5)$} \\
    I_b = K_b V_b & \mbox{$(6)$} \\
    I_C = I_c & \mbox{$(7)$}\\
    (I_B-I_A) R_3 = V_b & \mbox{$(8)$}\\
  \end{cases}
\end{equation}

\par
KVL was applied to meshes $A$ and $C$ to obtain equations (1) and (2) respectively. KVL can't be applied to meshes B and D, due to the current sources, so instead equations (3) and (4) were written, by direct inspection. Because the previous equations involve dependent sources, equations (5) to (8) were determined, allowing us to relate the output of said sources to the mesh currents. Equations (5) and (6) are given, equation (7) is determined by inspection of mesh $C$ and, lastly, equation (8) is the application of Ohm's law to $R_3$, with $(I_B-I_A)$ being the current that goes through that same resistor.

\begin{table}[hbt!]
  \centering
  \begin{tabular}{|c|c|}
    \hline    
    {\bf Mesh Currents} & {\bf Value [A]} \\ \hline
    \input{../mat/octave_mesh_tab.tex}
  \end{tabular}
  \caption{Mesh Current values determined through mesh analysis. The results or positive or negative depending on if the currents go in the direction indicated in the introductory drawing or not}
  \label{tab:mesh}
\end{table}

%\begin{equation}
%\begin{cases}
%R_6 I_3 + R_7 I_3 - V_c + R_4(I_3-I_1) = 0 & \mbox{KVL for mesh $C$}\\
%V_a - R_4 (I_3-I_1) - V_b + R_1 I_1 = 0 & \mbox{KVL for mesh $A$}\\
%V_c = K_c I_c & \mbox{as given for voltage source $V_c$} \\
%I_b = K_b V_b & \mbox{as given for current source $I_b$} \\
%I_3 = I_c & \mbox{by inspection in mesh $C$}\\
%I_4 = I_d & \mbox{by inspection in mesh $D$}\\
%(I_2-I_1) R_3 = V_b & \mbox{Ohm's Law for resistor $R_3$}\\
%I_2 = I_b & \mbox{by inspection in mesh $B$}\\
%\end{cases}
%\end{equation}



\subsection{Nodal Method}
\par



\begin{equation}
  \begin{cases}
    \frac{V_2-V_1}{R_1} + \frac{V_2-V_4}{R_3} + \frac{V_3-V_2}{R_2} = 0 & \mbox{$(1)$} \\
    \frac{V_3-V_2}{R_2} - (V_2-V_4) K_b = 0 & \mbox{$(2)$} \\
    \frac{V_5-V_4}{R_5} + K_b (V_2 - V_4) - I_d = 0 & \mbox{$(3)$}\\
    \frac{V_0-V_6}{R_6} - \frac{V_6-V_7}{R_7} = 0 & \mbox{$(4)$}\\
    V_0 = 0 & \mbox{$(5)$} \\
    V_1-V_0 = V_a & \mbox{$(6)$}  \\
    V_4-V_7 = K_c \frac{V_0-V_6}{R_6} & \mbox{$(7)$} \\
    \frac{V_2-V_4}{R_3} + \frac{V_5-V_4}{R_5} +  \frac{V_6-V_7}{R_7} - \frac{V_4-V_0}{R_4} - I_d = 0 & \mbox{$(8)$}
  \end{cases}
\end{equation}

\par
 In equations (1), (2), (3) and (4) we have KCL applied to nodes $N_2$, $N_3$, $N_5$ and $N_6$, respectively.  Using Ohm's law, one knows that $\frac{V_2 - V_1}{R_1}$ is the current that goes through resistor $R_1$, $\frac{V_3-V_2}{R_2}$ the one that goes through $R_2$, $\frac{V_2-V_4}{R_3}$ is the one through $R_3$, $\frac{V_5-V_4}{R_5}$ is the current through $R_5$, $\frac{V_0-V_6}{R_6}$ is the one through $R_6$ and $\frac{V_6-V_7}{R_7}$ the one through $R_7$. $I_d$ is the current imposed by current source $I_d$ while $V_2-V_4)K_b$ is the one imposed by $I_b$. KCL can't be applied to nodes $N_0$, $N_1$, $N_4$ and $N_7$. Instead, equations (5) to (8) are written. Equation (5) refers to $N_0$ being chosen as the ground node and equation (6) is reached by inspection in voltage source $V_a$. Equation (7) is determined by inspection in voltage source $V_c$, with $V_c = K_c I_c$ being the voltage imposed by voltage source $V_c$, and $I_c$ being the current that goes through resistor $R_6$, hence it is equal to $\frac{V_0 - V_6}{R_6}$. Besides that, $V_c = V_4-V_7$. Finally, because nodes $N_4$ and $N_7$ are connected by a current source, a super-node equation, (8), can be written by algebraically summing all currents flowing into or out of these nodes except the current related to the aforementioned source that connects these two nodes.



\begin{table}[hbt!]
  \centering
  \begin{tabular}{|c|c|}
    \hline    
    {\bf Node Potential} & {\bf Value [V]} \\ \hline
    \input{../mat/octave_node_tab.tex}
  \end{tabular}
  \caption{Node potentials determined through nodal analysis.}
  \label{tab:node}
\end{table}

%\begin{equation}
%\begin{cases}
%(1)V_0 = 0 & \mbox{since $N_0$ is the ground node} \\
%(2)V_1-V_0 = V_a & \mbox{by inspection in voltage source $V_a$}  \\
%(3)\frac{V_2-V_1}{R_1} + \frac{V_2-V_4}{R_3} + \frac{V_3-V_2}{R_2} = 0 & \mbox{KCL for node $N_2$} \\
%(4)\frac{V_3-V_2}{R_2} - (V_2-V_4) K_b = 0 & \mbox{KCL for node $N_3$} \\
%(5)\frac{V_0-V_6}{R_6} - \frac{V_6-V_7}{R_7} = 0 & \mbox{KCL for node $N_6$}\\
%(6)\frac{V_5-V_4}{R_5} + K_b (V_2 - V_4) - I_d = 0 & \mbox{KCL for node $N_5$}\\
%(7)V_4-V_7 = K_c \frac{V_0-V_6}{R_6} & \mbox{by inspection in voltage source $V_c$} \\
%(8)\frac{V_2-V_4}{R_3} + \frac{V_5-V_4}{R_5} +  \frac{V_6-V_7}{R_7} - \frac{V_4-V_0}{R_4} - I_d = 0 & \mbox{KCL for node $N_4$} \textcolor{red}{\textbf{     is actually a supernode!}}
%\end{cases}
%\end{equation}


\subsection{Comparing both methods}
\par
\begin{table}[hbt!]
  \centering
  \begin{tabular}{|l|r|r|}
    \hline    
    {\bf Mesh Current} & {\bf Mesh Method [A]} & {\bf Method Comparison Equations [A]} \\ \hline
    \input{../mat/octave_comparison_tab.tex}
  \end{tabular}
  \caption{Mesh Currents determined through mesh analysis (same as in table \ref{tab:mesh}) and through the comparison equations based on the nodal potentials determined by nodal analysis}
  \label{tab:comp}
\end{table}



\par
After solving a linear system of equations with Octave, it was found out that the results obtained through both methods match. This confirms that they are equivalent.

\begin{equation}
\begin{cases}
I_A= \frac{V_2-V_1}{R_1} & \mbox{$(1)$}\\
I_B= \frac{V_3-V_2}{R_2} & \mbox{$(2)$}\\
I_C= -\frac{V_7-V_6}{R_7} & \mbox{$(3)$}\\
I_D= -\frac{V_4-V_5}{R_5} +I_B & \mbox{$(4)$}
\end{cases}
\end{equation}

\par
Using the values obtained through the nodal analysis for the potentials, the value for the current through each essential mesh was calculated and then compared to the one obtained through the mesh method as shown in the table below.

\par
In the previous equations Ohm's law is applied to a resistor in the respective essential mesh. In equation (4), since resistor $R_5$ belongs to two essential meshes, $B$ and $D$, the current that goes through it is the difference between the current in each of those meshes.
