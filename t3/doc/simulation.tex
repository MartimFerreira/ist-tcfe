\section{Simulation Analysis}
\label{sec:simulation}

In this section, $ngspice$ results for the circuit shown above are presented. The AC/DC converter was simulated for 10 periods and the default model was used for the diodes.

Since this laboratory assignment consisted of an optimization problem, to start off we used a more elementary model and after verifying it was working properly, modifications were made in order to improve the quality of the circuit. In this particular case, that meant having the smallest output voltage ripple and the smallest cost possible. Also we wanted to have an output voltage average as close as possible to the $12 V$ we intended.


\subsection{Average output voltage level}
First and foremost, the average output voltage level was determined using Ngspice's $mean(vector)$ function. There was also another possible function for that $avg(vector)$, though the first one seemed more suitable. The average was calculated for over 1000 points.

The value obtained here was %-------------------insert value-----------------
which has a deviation of the ideal $12 V$ of %-------------------deviation in perecentage-----------------
%maybe refer number of significant diits




\subsection{Output voltage ripple}
Using Ngspice's $MIN$ and $MAX$ functions, the output voltage ripple was obtained. It had a value of %----------------------insert value----------------
which is approximately zero, as wanted.



% this means that the output voltage signal, despite being sinusoidal, has a magnitude that is basically $12 V$ and a ripple that is virtually null, therefore it is a pretty good approximantion of a constant output voltage signal of $12 V$.



\subsection{Output voltages for the Envelope Detector and the Voltage Regulator circuits}
In the graph below are the plots of the output voltages for the Envelope Detector and the Voltage Regulator circuits as a function of time.
%comment something about that
%include figure


\begin{figure}[H] \centering
\includegraphics[width=0.6\linewidth]{../sim/trans_regulator.pdf}
\caption{Output voltage for Envelope Detector (v(mid1), in red) and Voltage Regulator (v(out1), in blue)}
\label{fig:phase_sim}
\end{figure}


\subsection{Output AC component and DC deviation}
Finally, there is the plot of $v_o -12$, where $v_o$ is the circuit's output voltage.
%comment something about that
%include figure


\begin{figure}[H] \centering
\includegraphics[width=0.6\linewidth]{../sim/trans_centered_output.pdf}
\caption{Difference (im mV) between the Output Voltage and the desired 12V}
\label{fig:phase_sim}
\end{figure}


\subsection{Merit figure calculation}
Given all the above-mentioned points, it is now possible to calculate the merit figure.
%develop further

\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline    
    {\bf Name} & {\bf ngspice Values} & {\bf Theoretically Predicted Values} \\ \hline
    \input{merit_tab.tex}
  \end{tabular}
  \caption{Values determined as part of the merit calculation procedure.}
  \label{tab:merit}
\end{table}

